# 在 Excel 和 Python 中计算风险值(VaR)

> 原文:[https://blog . quantin STI . com/calculating-value-at-risk-in-excel-python/](https://blog.quantinsti.com/calculating-value-at-risk-in-excel-python/)

由[查尼卡·塔卡](https://www.linkedin.com/in/chainika-bahl-thakar-b32971155/)

在一项投资中，我最多会损失多少？这是每个投资过的投资人在某个时间点都会问的问题。风险价值(VaR)试图提供一个答案，因为它是投资组合承受的最大预期损失的度量。

我们将使用历史方法和方差-协方差方法理解并执行 Excel 和 Python 中的 VaR 计算，以及本博客中的示例，包括:

*   [什么是 VaR？](#what-is-var)
*   [为什么要用 VaR？](#why-use-var)
*   [使用 VaR 时需要知道的要点](#essential-points-to-know-while-using-var)
*   [Excel 中 VaR 是如何计算的？](#how-is-var-calculated-in-excel)
*   [使用方差-协方差方法计算风险值](#var-calculation-using-variance-covariance-approach)
*   [使用历史模拟方法计算风险值](#var-calculation-using-the-historical-simulation-approach)

* * *

## 什么是 VaR？

风险价值(VaR)是在通常的市场条件下，衡量特定时期内最糟糕的预期损失。使用 90%至 99%范围内的“置信度”来衡量风险值，如 90%、95%或 99%。金融工具的持有期可能从一天到一年不等。

换句话说，VaR 是对市场风险的一种度量。它是在给定的时间段内，在一定的置信区间内可能发生的最大损失的度量。使用 VaR，金融机构可以确定弥补损失所需的充足资本储备。此外，风险值有助于确定是否需要减少高于可接受风险的持有量。

根据 Philippe Jorion 的说法，
*VaR 衡量的是在正常市场条件下，给定置信水平*下，给定期限内的最坏预期损失。

此外，根据⁽ ⁾的一项研究[得出的结论是，风险值并不提供任何确定性，而是基于某些假设的结果预期。](https://lup.lub.lu.se/luur/download?func=downloadFile&recordOId=1669008&fileOId=2435920)

* * *

## 例子

让我们用一个例子来理解 VaR。

假设，一个分析师说一个投资组合的 1 天风险值是 100 万美元，置信度为 95%。

*   这意味着有 95%的可能性单日最大损失不会超过 100 万美元。
*   换句话说，某一天投资组合损失超过 100 万美元的可能性只有 5%。在 Quantra 课程中详细学习[量化投资组合管理](https://quantra.quantinsti.com/course/quantitative-portfolio-management)。

* * *

## 为什么要用 VaR？

现在，让我们来看看为什么要用 VaR 或风险价值来衡量预期损失。交易者利用风险值的原因如下:

*   理解风险价值结果很容易
*   适用于所有资产类型
*   普遍使用

### 理解风险价值的结果很容易

风险价值代表一个交易者投资一个投资组合所承担的风险程度。例如，风险价值介于 90%和 99%之间，这使得解释风险水平变得容易。

### 适用于所有资产类型

Vale at Risk 可以很容易地应用于所有资产类型，即债券、股票、货币、衍生品等。此外，各种金融机构和银行都利用风险价值来评估投资组合或资产交易的盈利能力。在 Quantra 课程中详细学习[交易的金融时间序列分析](https://quantra.quantinsti.com/course/financial-time-series-analysis-trading)。

### 普遍使用

风险价值是买卖和所有交易相关活动的公认标准。因此，你可以在全球任何地方使用它。

* * *

## 使用 VaR 时需要知道的要点

交易者在使用风险值来衡量投资组合或金融工具的风险时，必须知道几个要点。这些要点是:

**1。很难计算具有多种资产(如现金、货币、股票等)的投资组合的风险值。)或更多数量的资产**

计算投资组合的风险价值需要计算每项资产的风险和回报。但是，在计算风险回报的同时，也要计算资产之间的相关性。因此，投资组合中资产的数量或多样性越多，计算风险值就越困难。

**2。不同的方法或途径导致不同的结果**

当计算 VaR 的不同方法导致同一投资组合或金融工具的不同结果时，这意味着收益分布是不正态的。

* * *

## Excel 中 VaR 是如何计算的？

有两种众所周知的方法用于计算风险值。

在这篇博客中，我们将讨论以下内容:

*   方差-协方差方法
*   历史模拟方法

让我们从**方差-协方差方法**开始。

方差-协方差是一种参数方法，它假设收益是正态分布的。在这种方法中，

*   我们首先计算收益的均值和标准差
*   根据假设，对于 95%的置信水平，VaR 计算为平均值-1.65 *标准差
*   此外，根据假设，对于 99%的置信水平，VaR 计算为均值-2.58 *标准差

请注意，上述数字是基于主观假设 [⁽ ⁾](https://stats.stackexchange.com/questions/580695/why-confidence-level-95-is-1-65) 。

接下来，使用**历史模拟方法**计算风险值的步骤如下:

1.  类似于方差-协方差方法，首先我们计算股票收益=今天的价格-昨天的价格/昨天的价格
2.  将收益从最差到最好排序。
3.  接下来，我们计算退货的总数。
4.  VaR(90)是对应于总计数的 10%的排序返回。
5.  类似地，VaR(95)和 VaR(99)是分别对应于总计数的 5%和 1%的排序返回。

## 使用方差-协方差方法计算风险值

现在，我们将使用 Python 找出方差-协方差方法的计算。